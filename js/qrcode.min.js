var QRCode;
(function(){function a(a){this.mode=c.MODE_8BIT_BYTE,this.data=a,this.parsedData=[];for(var b=0,d=this.data.length;b<d;b++){var e=this.data.charCodeAt(b);e>65536?(this.parsedData.push(240|e>>>18),this.parsedData.push(128|e>>>12&63),this.parsedData.push(128|e>>>6&63),this.parsedData.push(128|63&e)):e>2048?(this.parsedData.push(224|e>>>12),this.parsedData.push(128|e>>>6&63),this.parsedData.push(128|63&e)):e>128?(this.parsedData.push(192|e>>>6),this.parsedData.push(128|63&e)):this.parsedData.push(e)}this.parsedData.push}function b(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function i(a,b){if(void 0==a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function j(a,b){this.genPoly=a,this.degree=b}function k(a,b){var c=new i(a,!0),d=new i(b,!0),e=c.offset(d.getLength()-1),f=e.multiply(d.inverse());return[f,c.subtract(f.multiply(c))]}function l(a,c){for(var d=j.getErrors(a,c),e=new Array(a.getLength()),f=0;f<d.length;f++)e[d[f]]=1;for(var g=new i(e,!0),h=new i([1],!0).offset(a.getLength()),l=k(h,g)[0],m=l.getLength()-1,n=new Array(m),o=0;o<m;o++)n[o]=l.getCoefficient(m-o);for(var p=new Array(m),q=0;q<m;q++){var r=j.EXP_TABLE[a.getLength()-1-d[q]];p[q]=j.LOG_TABLE[n[q]]+r<j.EXP_TABLE.length?j.EXP_TABLE[j.LOG_TABLE[n[q]]+r]:0}for(var s=0,t=0;t<m;t++)s^=p[t];for(var u=new Array(a.getLength()),v=0;v<a.getLength();v++)u[v]=j.LOG_TABLE[a.getCoefficient(v)]-s<0?j.EXP_TABLE[j.LOG_TABLE[a.getCoefficient(v)]-s+j.EXP_TABLE.length-1]:j.EXP_TABLE[j.LOG_TABLE[a.getCoefficient(v)]-s];return u}function m(a,b){var c=b||{};this.options=c;var d=new QRCode(c.typeNumber||-1,c.errorCorrectLevel||g.H);d.addData(a),d.make();var e=c.cellSize||2,f=c.margin||4*e;this.getCells=function(){return d.modules},this.getCells.length=d.moduleCount,this.make=function(){var a=document.createElement("canvas");if(a.width=a.height=f+this.getCells.length*e,!a.getContext)throw"canvas support is needed for this library";var b=a.getContext("2d");b.fillStyle=c.background||"#fff",b.fillRect(0,0,a.width,a.height),b.fillStyle=c.foreground||"#000";for(var g=0;g<this.getCells.length;g++)for(var h=0;h<this.getCells.length;h++)this.getCells[g][h]&&b.fillRect(f+h*e,f+g*e,e,e);return a},this.toDataURL=function(){return this.make().toDataURL()},this.toImageData=function(){return this.make().getContext("2d").getImageData(0,0,this.getCells.length,this.getCells.length)}}a.prototype={getLength:function(){return this.parsedData.length},write:function(a){for(var b=0;b<this.parsedData.length;b++)a.put(this.parsedData[b],8)}},b.prototype={addData:function(b){var c=new a(b);this.dataList.push(c),this.dataCache=null},isDark:function(a,b){if(a<0||this.moduleCount<=a||b<0||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),this.typeNumber>=7&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=b.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,b){for(var c=-1;c<=7;c++)if(!(a+c<=-1||this.moduleCount<=a+c))for(var d=-1;d<=7;d++)b+d<=-1||this.moduleCount<=b+d||(0<=c&&c<=6&&(0==d||6==d)||0<=d&&d<=6&&(0==c||6==c)||2<=c&&c<=4&&2<=d&&d<=4?(this.modules[a+c][b+d]=!0):(this.modules[a+c][b+d]=!1))},getBestMaskPattern:function(){for(var a=0,b=0,c=0;c<8;c++){this.makeImpl(!0,c);var d=f.getLostPoint(this);(0==c||a>d)&&(a=d,b=c)}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(var b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=0==b%2)},setupPositionAdjustPattern:function(){for(var a=f.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var g=-2;g<=2;g++)for(var h=-2;h<=2;h++)-2==g||2==g||-2==h||2==h||0==g&&0==h?(this.modules[d+g][e+h]=!0):(this.modules[d+g][e+h]=!1)}},setupTypeNumber:function(a){for(var b=f.getBCHTypeNumber(this.typeNumber),c=0;c<18;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;c<18;c++){var d=!a&&1==(b>>c&1);this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){for(var c=this.errorCorrectLevel<<3|b,d=f.getBCHTypeInfo(c),e=0;e<15;e++){var g=!a&&1==(d>>e&1);e<6?this.modules[e][8]=g:e<8?this.modules[e+1][8]=g:this.modules[this.moduleCount-15+e][8]=g}for(var e=0;e<15;e++){var g=!a&&1==(d>>e&1);e<8?this.modules[8][this.moduleCount-e-1]=g:e<9?this.modules[8][15-e-1+1]=g:this.modules[8][15-e-1]=g}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,g=0,h=this.moduleCount-1;h>0;h-=2)for(6==h&&h--;;){for(var i=0;i<2;i++)if(null==this.modules[d][h-i]){var j=!1;g<a.length&&(j=1==(a[g]>>>e&1));f.getMask(b,d,h-i)&&(j=!j),this.modules[d][h-i]=j,e--,-1==e&&(g++,e=7)}if(d+=c,d<0||this.moduleCount<=d){d-=c,c=-c;break}}}};var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},g={L:1,M:0,Q:3,H:2},e={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,52,78,102],[6,30,54,82,106],[6,28,56,84,110],[6,32,58,88,114],[6,30,58,86,118],[6,34,62,90,122],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;e.getBCHDigit(b)-e.getBCHDigit(e.G15)>=0;)b^=e.G15<<e.getBCHDigit(b)-e.getBCHDigit(e.G15);return(a<<10|b)^e.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;e.getBCHDigit(b)-e.getBCHDigit(e.G18)>=0;)b^=e.G18<<e.getBCHDigit(b)-e.getBCHDigit(e.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>=1;return b},getPatternPosition:function(a){return e.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw new Error("bad maskPattern:"+a)}},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var g=0,h=a.isDark(d,e),i=-1;i<=1;i++)if(!(d+i<0||b<=d+i))for(var j=-1;j<=1;j++)e+j<0||b<=e+j||0==i&&0==j||h==a.isDark(d+i,e+j)&&g++;g>5&&(c+=3+g-5)}for(var d=0;d<b-1;d++)for(var e=0;e<b-1;e++){var k=0;a.isDark(d,e)&&k++,a.isDark(d+1,e)&&k++,a.isDark(d,e+1)&&k++,a.isDark(d+1,e+1)&&k++,(0==k||4==k)&&(c+=3)}for(var d=0;d<b;d++)for(var e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;e<b;e++)for(var d=0;d<b-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(var l=0,e=0;e<b;e++)for(var d=0;d<b;d++)a.isDark(d,e)&&l++;var m=Math.abs(100*l/b/b-50)/5;return c+=10*m},stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);b.push(255&d)}return b},createData:function(a,c,d){for(var e=h[c],i=new j(a,e),k=0,l=0;l<d.length;l++)k+=d[l].getLength();for(var m=new Array(k),n=0,o=0;o<d.length;o++){var p=d[o];m[n++]=p.mode,m[n++]=p.getLength(),p.write(i)}for(var q=0,r=i.getBuffer(),s=0;s<e.length;s++){var t=e[s][0],u=e[s][1],v=e[s][2];for(s=0;s<v;s++){for(var w=new Array(t),x=0;x<t;x++)w[x]=255&r[x+q];var y=f.getErrorCorrectPolynomial(t-u),z=new i(w,t-u).mod(y),A=new Array(y.getLength()-1);for(x=0;x<A.length;x++)A[x]=z.getCoefficient(A.length-x-1);for(x=0;x<A.length;x++)r[q+t+x]=A[x];q+=t+A.length}}return r}},b.PAD0=236,b.PAD1=17;for(var d=b,f={},h=[[10,7,17],[16,10,28],[22,15,44],[28,20,64]],k=0;k<8;k++)d.RS_BLOCK_TABLE[k]=[];for(var k=0;k<d.RS_BLOCK_TABLE.length;k++)for(var n=0;n<d.RS_BLOCK_TABLE[k].length;n++)d.RS_BLOCK_TABLE[k][n]=[];i.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=j.gexp(j.glog(this.get(c))+j.glog(a.get(d)));return new i(b,!0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=j.glog(this.get(0))-j.glog(a.get(0)),c=new Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(var d=0;d<=this.getLength()-a.getLength();d++){var e=j.glog(c[d])-j.glog(a.get(0))+b;if(e<0)throw new Error("bad mod");for(var f=0;f<a.getLength();f++)c[d+f]^=j.gexp(j.glog(a.get(f))+e)}return new i(c,!0).mod(a)}},j.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},getCoefficient:function(a){return this.num[this.num.length-1-a]},getErrors:function(a,b){for(var c=new i([1],!0).offset(b),d=k(c,a)[1],e=d.getLength()-1,f=new Array(e),g=0;g<e;g++)f[g]=d.getCoefficient(e-g);for(var h=[],j=0;j<256;j++){for(var l=0,m=0;m<e;m++)l^=this.EXP_TABLE[this.LOG_TABLE[f[m]]+this.LOG_TABLE[this.EXP_TABLE[m*j]]<this.EXP_TABLE.length?this.LOG_TABLE[f[m]]+this.LOG_TABLE[this.EXP_TABLE[m*j]]:0];0==l&&h.push(j)}if(h.length!=e)throw new Error("error locating failed");return h}},j.getErrors=function(a,b){for(var c=new j(b),d=new Array(b),e=0;e<b;e++){var f=j.gexp(e);d[e]=c.evaluate(f)}for(var g=new i(d,!0),h=new i([1],!0).offset(b),l=k(h,g)[0],m=l.getLength()-1,n=new Array(m),o=0;o<m;o++)n[o]=l.getCoefficient(m-o);for(var p=[],q=0;q<256;q++){for(var r=0,s=0;s<m;s++)r^=j.gexp(j.glog(n[s])+j.glog(j.gexp(s*q)));0==r&&p.push(j.gexp(255-q))}if(p.length!=m)throw new Error("error locating failed");return p},j.LOG_TABLE=new Array(256),j.EXP_TABLE=new Array(255);for(var o=0;o<8;o++)j.EXP_TABLE[o]=1<<o;for(var o=8;o<256;o++)j.EXP_TABLE[o]=j.EXP_TABLE[o-4]^j.EXP_TABLE[o-5]^j.EXP_TABLE[o-6]^j.EXP_TABLE[o-8];for(var o=0;o<255;o++)j.LOG_TABLE[j.EXP_TABLE[o]]=o;var p=[];j.getErrorCorrectPolynomial=function(a){for(var b=new i([1],!0),c=0;c<a;c++)b=b.multiply(new i([1,j.gexp(c)],!0));return b},QRCode=b,QRCode.stringToBytes=f.stringToBytes,QRCode.QRCode=m,this.QRCode=QRCode}).call(this);